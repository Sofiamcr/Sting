<div class = "container">  <div class="row justify-content-center">
  <div class="col-12">
    <div class="center-element">
      <h1 class="background-color-black"><%= @challenge.name %></h1>
      <%# <p>Week nr: <%= ((@challenge.end_date - @challenge.start_date).to_i/7).round %></p>
      <div><h2><span class="yellow-border-font">Challenge </span> Goal: <span class=""><%=@challenge.challenge_qty %> <%=@challenge.unit%></span></h2></div>
      <p>This Week Goal:  <%= @challenge.goal_qty%> <%=@challenge.unit%></p>
      <p>This week progress: <%= @challenge.weekly_progresses.sum(:progress) %> <%= @challenge.unit %></p>
    </div>
  </div>
</div>

 <%# Progress bars with avatars bootstrap %>

  <div class="row justify-content-center">
    <div class ="col-12">
      <div class="card">
        <h2>Progress Total</h2>
        <% @challenge.participations.each do |participation| %>
          <div class="progress">
            <div class="progress-bar progress-bar-striped progress-bar-animated"
              role="progressbar"
              aria-label="Animated striped example"
              aria-valuenow="<%= ( participation.user.weekly_progresses.sum(:progress)  / @challenge.challenge_qty ) * 100%>%"
              aria-valuemin="0"
              aria-valuemax="100"
              style="width:<%= ( participation.user.weekly_progresses.sum(:progress) / participation.challenge.challenge_qty ) * 100%>%">
                <span class= "icon"><%= cl_image_tag participation.user.photo.key, class:"avatar-small"%></span>
              </div>
          </div>
        <% end %>
      </div>




     <%# Circle progress in js %>



      <div class="card">

        <h2>Who's leading this week?</h2>
        <div class="list-group image-percent">
          <% @challenge.participations.each do |participation| %>
            <div data-controller="chart" class="imgfondo" data-chart-target="graph" data-value=<%= participation.user.id%>>
                <div data-controller="tooltip" data-bs-toggle="tooltip" data-bs-placement="top" title="<%= participation.user.first_name %>">
                  <%= cl_image_tag participation.user.photo.key, class: "avatar-progress stack-top" %>
                </div>
            </div>
          <% end %>
        </div>


        <%# <div data-controller="clipboard" data-clipboard-success-content="Copied!">
          <input type="text" value="Click the button to copy me!" data-clipboard-target="source" />
           <button type="button" data-action="clipboard#copy" data-clipboard-target="button">Copy to clipboard</button>
        </div> %>
        <%# <div data-controller="clipboard"  class="share">
          <input data-clipboard-target="source" type="text" value= "<%=new_challenge_participation_path(@challenge)%>
          <%# <button data-action="clipboard#copy"><i  class="fa-solid fa-link"></i></button>
        </div> %>

        <%# <div data-controller="clipboard" data-action="click->clipboard#copy"  data-clipboard-target="button" >
          <%= data-clipboard-target="source" link_to new_challenge_participation_path(@challenge) do%>
          <%# <i  class="fa-solid fa-link"></i>
          <% end %>
        <%# </div> %>

<div class="share">
    <%= link_to new_challenge_participation_path(@challenge) do%>
      <i class="fa-solid fa-link"></i>
    <% end %>
  </div>
</div>




<div data-controller="reveal" data-reveal-hidden-class="d-none">
  <button data-action="click->reveal#toggle" type="button" class="btn btn-sting">Stinger Cards</button>

  <div data-reveal-target="item" class="d-none mt-4">
    <div class="card card-body">
          <h2>Let's sting your enemies</h2>
          <%# Each card %>
          <div class= "d-flex flex-row">
            <% @user_cards.each do |card| %>
              <div class="flip-box">
                <div class="flip-box-inner">
                  <div class="flip-box-front">
                    <%= image_tag "face_down_card.png", alt: "StingyCard", class:"StingyCard" %>
                  </div>
                  <div class="flip-box-back">
                  <%# esto va a ser un boton %>
                  <%= link_to "apply cards", select_participant_challenge_participation_path(@challenge, @user_participation, card: card.id), class: "btn btn-primary"%>
                    <%= image_tag card.action , alt: "CardValue", class:"CardValue" %>
                  </div>
                </div>
              </div>
            <% end %>
        </div>
  </div>
</div>



<div data-controller="insert-message" class="messagebox">
  <div data-insert-message-target="messages" class="allmessages">
    <% @challenge.messages.each do |m| %>
      <% if m.user == current_user %>
        <%= render "messages/message", message: m, css_class_one: "message-current-user" %>
         <%# <% elsif m.stingy %>
        <%# <%= render "messages/message", message: m, css_class_one: "message-stingy" %>
      <% else %>
        <%= render "messages/message", message: m, css_class_one: "message-user" %>
      <% end %>
    <% end %>
  </div>
    <%= render "messages/new_message", message: @message, challenge: @challenge %>
</div>
